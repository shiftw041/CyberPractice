# å…¥é—¨çŸ¥è¯†

## é™æ€è°ƒè¯•å·¥å…·-IDA Pro

### ç®€ä»‹

IDA Proï¼ˆinteractive Disassembler Professionalï¼‰æ˜¯ç”± Hex-Rays å…¬å¸å‡ºå“çš„ä¸€æ¬¾äº¤äº’å¼åæ±‡ç¼–å·¥å…·ï¼Œä¹Ÿæ˜¯è½¯ä»¶é€†å‘å·¥ç¨‹å½“ä¸­æœ€æµè¡Œçš„ä¸€ä¸ªé™æ€åˆ†æå·¥å…·ã€‚

### åŸºæœ¬ç”¨æ³•

IDA Pro é€šå¸¸ä¼šæä¾› `ida.exe` ä¸ `ida64.exe` ä¸¤ä¸ªå¯æ‰§è¡Œç¨‹åºï¼Œåˆ†åˆ«å¯¹åº”äºé€†å‘ `32` ä½ä¸ `64` ä½ç¨‹åºã€‚å½“æˆ‘ä»¬éœ€è¦ä½¿ç”¨ IDA Pro åˆ†ææŸä¸€å¯æ‰§è¡Œç¨‹åºäºŒè¿›åˆ¶æ–‡ä»¶æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®ç¨‹åºæŒ‡ä»¤é›†é•¿åº¦çš„ä¸åŒé€‰æ‹©ä½¿ç”¨ä¸åŒçš„ `ida` ã€‚

æœ€ç®€å•çš„ä½¿ç”¨æ–¹å¼æ˜¯å°†å¾…é€†å‘çš„äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶ç›´æ¥æ‹–æ”¾åˆ° IDA ä¸Šï¼ŒIDA ä¼šè‡ªåŠ¨è¯†åˆ«æ–‡ä»¶ç±»å‹ï¼Œè¿™ä¸€æ­¥é€šå¸¸ä¸éœ€è¦åšæ”¹åŠ¨ï¼Œç›´æ¥ç‚¹å‡» ğŸ†— å³å¯ï¼š

![img](https://ctf-wiki.org/reverse/tools/static-analyze/figure/ida_load.png)

æ¥ä¸‹æ¥æˆ‘ä»¬å°±ä¼šçœ‹åˆ°è¿™æ ·ä¸€ä¸ªç•Œé¢ï¼š

![img](https://ctf-wiki.org/reverse/tools/static-analyze/figure/ida_ui.png)

- `Function Windows` ï¼šIDA æ‰€è¯†åˆ«å‡ºæ¥çš„å‡½æ•°åˆ—è¡¨ï¼Œé€šè¿‡è¯¥ç›®å½•å¯ä»¥ç›´æ¥è·³è½¬åˆ°å¯¹åº”å‡½æ•°
- `IDA-View` ï¼šä»¥æ±‡ç¼–å½¢å¼å‘ˆç°çš„ç”± IDA è¿›è¡Œåç¼–è¯‘æ‰€å¾—çš„å•ä¸ªå‡½æ•°ç»“æœï¼Œé»˜è®¤æ˜¯ä»¥ç”±åŸºæœ¬å—æ„æˆçš„æ§åˆ¶æµå›¾çš„å½¢å¼è¿›è¡Œå±•ç¤ºï¼Œä¹Ÿå¯ä»¥é€šè¿‡ `ç©ºæ ¼` é”®åˆ‡æ¢åˆ°å†…å­˜å¸ƒå±€ä¸­çš„åŸå§‹æ±‡ç¼–ä»£ç 
- `Hex View` ï¼š äºŒè¿›åˆ¶æ–‡ä»¶çš„åŸå§‹æ•°æ®è§†å›¾
- `Structures` ï¼šç”± IDA æ‰€è¯†åˆ«å‡ºæ¥çš„ç¨‹åºä¸­å¯èƒ½å­˜åœ¨çš„ç»“æ„ä½“ä¿¡æ¯
- `Enums` ï¼šç”± IDA æ‰€è¯†åˆ«å‡ºæ¥çš„ç¨‹åºä¸­å¯èƒ½å­˜åœ¨çš„æšä¸¾ä¿¡æ¯
- `Imports` ï¼š è¯¥äºŒè¿›åˆ¶æ–‡ä»¶è¿è¡Œæ—¶å¯èƒ½éœ€è¦ä»å¤–éƒ¨å¯¼å…¥çš„ç¬¦å·
- `Exports` ï¼š è¯¥äºŒè¿›åˆ¶æ–‡ä»¶å¯ä»¥è¢«å¯¼å‡ºåˆ°å¤–éƒ¨çš„ç¬¦å·

### å‡½æ•°åç¼–è¯‘

é™¤äº†åæ±‡ç¼–ä»¥å¤–ï¼ŒIDA ä¹Ÿæ”¯æŒå°†æ±‡ç¼–ä»£ç åç¼–è¯‘ä¸º C/C++ å½¢å¼çš„æºä»£ç ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨å¾…åç¼–è¯‘çš„å‡½æ•°ä½ç½®æŒ‰ä¸‹ `F5` å³å¯è·å¾—åç¼–è¯‘åçš„ç¨‹åºä»£ç ï¼š

![img](https://ctf-wiki.org/reverse/tools/static-analyze/figure/ida_discompile.png)

æœ‰çš„æ—¶å€™ IDA å¯¹äºå‡½æ•°èŒƒå›´çš„è¯†åˆ«å¯èƒ½ä¼šæœ‰ä¸€å®šé”™è¯¯ï¼Œä»è€Œå¯¼è‡´åç¼–è¯‘ç»“æœå‡ºç°åå·®ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥åœ¨ `IDA-View` çª—å£ä¸­çš„å‡½æ•°å¼€å¤´æŒ‰ä¸‹ `alt+p` é‡æ–°å®šä¹‰å‡½æ•°èŒƒå›´ï¼Œæˆ–æ˜¯å…ˆæŒ‰ä¸‹ `u` å–æ¶ˆåŸæœ‰å®šä¹‰åå†æ¡†é€‰å‡½æ•°èŒƒå›´åé‡æ–°æŒ‰ä¸‹ `p` è¿›è¡Œå®šä¹‰ï¼š

![img](https://ctf-wiki.org/reverse/tools/static-analyze/figure/ida_edit_func.png)

æœ‰çš„æ—¶å€™å› ä¸ºä»£ç æ··æ·†ç­‰åŸå› å¯¼è‡´ IDA æ— æ³•å»ºç«‹å‡½æ•°ï¼š

![img](https://ctf-wiki.org/reverse/tools/static-analyze/figure/ida_fail_to_discompile.png)

å½“æˆ‘ä»¬å®Œæˆå¯¹å‡½æ•°è¯†åˆ«çš„ä¿®å¤ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å‡½æ•°å¼€å¤´æŒ‰ä¸‹ `p` è®© IDA é‡æ–°è‡ªåŠ¨è¯†åˆ«å‡½æ•°ï¼Œæˆ–æ˜¯æ¡†é€‰å±äºè¯¥å‡½æ•°çš„æ±‡ç¼–ä»£ç ä¹‹åå†æŒ‰ä¸‹ `p` è®© IDA é‡æ–°è‡ªåŠ¨è¯†åˆ«å‡½æ•°ï¼š

![img](https://ctf-wiki.org/reverse/tools/static-analyze/figure/ida_reidentify_func1.png)

![img](https://ctf-wiki.org/reverse/tools/static-analyze/figure/ida_reidentify_func2.png)

### IDAPython

åœ¨ IDA Pro å½“ä¸­å†…ç½®äº†ä¸€ä¸ª Python åŠä¸€ä¸ª IDC æ¨¡å—ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿåœ°å¯¹äºŒè¿›åˆ¶æ–‡ä»¶è¿›è¡Œä¿®æ”¹ç­‰å·¥ä½œã€‚

æˆ‘ä»¬å¯ä»¥é€šè¿‡ `File` â†’ `Script Command` ç›´æ¥ç¼–å†™è¿è¡Œ IDAPython è„šæœ¬ï¼š

![img](https://ctf-wiki.org/reverse/tools/static-analyze/figure/ida_python.png)

åœ¨ä½¿ç”¨ä¹‹å‰éœ€è¦å…ˆå¯¼å…¥ `ida` æ¨¡å—ï¼Œæ¯”è¾ƒå¸¸ç”¨çš„æœ‰ä»¥ä¸‹ APIï¼š

```
idc.get_db_byte(addr)       # è¿”å› addr å¤„çš„ 1 å­—èŠ‚
idc.get_wide_word(addr)     # è¿”å› addr å¤„çš„ 2 å­—èŠ‚
idc.get_wide_dword(addr)    # è¿”å› addr å¤„çš„ 4 å­—èŠ‚
idc.get_qword(addr)         # è¿”å› addr å¤„çš„ 8 å­—èŠ‚
idc.get_bytes(addr, size, use_dbg) # è¿”å› addr å¤„çš„ size å­—èŠ‚
idc.patch_byte(addr, value)  # å°† addr å¤„çš„ 1 å­—èŠ‚ä¿®æ”¹ä¸º valueï¼ˆå°ç«¯åºï¼‰
idc.patch_word(addr, value)  # å°† addr å¤„çš„ 2 å­—èŠ‚ä¿®æ”¹ä¸º valueï¼ˆå°ç«¯åºï¼‰
idc.patch_dword(addr, value) # å°† addr å¤„çš„ 4 å­—èŠ‚ä¿®æ”¹ä¸º valueï¼ˆå°ç«¯åºï¼‰
idc.patch_qword(addr, value) # å°† addr å¤„çš„ 8 å­—èŠ‚ä¿®æ”¹ä¸º valueï¼ˆå°ç«¯åºï¼‰
```

æ›´å¤š API åŠç”¨æ³•å‚è§[å®˜æ–¹æ–‡æ¡£](https://hex-rays.com/products/ida/support/idapython_docs/)ã€‚

### IDA æ’ä»¶

IDA æ”¯æŒæ’ä»¶æ‰©å±•ï¼Œé€šè¿‡æ’ä»¶æ‰©å±•æˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿åœ°æ‰©å±•åŠå¢å¼º IDA çš„åŠŸèƒ½ã€‚

æ’ä»¶çš„å®‰è£…é€šå¸¸æ¯”è¾ƒç®€å•ï¼Œä»¥ `FindCrypt` æ’ä»¶ä¸ºä¾‹ï¼Œè¯¥æ’ä»¶å¯ä»¥å¸®æˆ‘ä»¬è‡ªåŠ¨è¯†åˆ«ç¨‹åºå½“ä¸­å­˜åœ¨çš„å¯†ç ç®—æ³•ã€‚è¦å®‰è£…è¯¥æ’ä»¶ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦åœ¨ [Github](https://github.com/polymorf/findcrypt-yara) ä¸Šè·å–æ’ä»¶æºç ï¼Œå¹¶å°†å…¶æ”¾ç½®åˆ° `IDAå®‰è£…è·¯å¾„/plugins` æ–‡ä»¶å¤¹ä¸‹ï¼š

![img](https://ctf-wiki.org/reverse/tools/static-analyze/figure/ida_findcrypt_files.png)

è‹¥ç³»ç»Ÿä¸­æœªå®‰è£… `yara` æ¨¡å—åˆ™éœ€è¦è¿›è¡Œå®‰è£…ï¼š

```
$ python -m pip install yara-python
```

æ­¤æ—¶æˆ‘ä»¬ä¾¿èƒ½åœ¨ `Editâ†’Plugin` ä¸­ä½¿ç”¨è¯¥æ’ä»¶ï¼š

![img](https://ctf-wiki.org/reverse/tools/static-analyze/figure/ida_findcrypt.png)

# å¸¸ç”¨å·¥å…·



-   IDA Proï¼š[ã€é€†å‘ã€‘IDA Pro](https://zhuanlan.zhihu.com/p/474207234)

# å®æˆ˜æ¡ˆä¾‹

[Reverse---Mysteriousï¼ˆWPï¼‰](https://zhuanlan.zhihu.com/p/364062274)

[ä¸­èŒç½‘ç»œå®‰å…¨æ¯”èµ›é€†å‘å…¥é—¨æ•™ç¨‹](https://blog.csdn.net/qq_45894840/article/details/124012813)

# å‚è€ƒèµ„æ–™

[ã€é€†å‘ã€‘é™æ€åˆ†ææŠ€æœ¯](https://zhuanlan.zhihu.com/p/438800930)

[ã€é€†å‘ã€‘IDA Pro](https://zhuanlan.zhihu.com/p/474207234)

CTFeræˆé•¿ä¹‹è·¯-Nu1Læˆ˜é˜Ÿ-é€†å‘éƒ¨åˆ†